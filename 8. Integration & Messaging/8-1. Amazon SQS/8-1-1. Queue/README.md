# Queue

# Standard Queue

* Standard Queue는 SQS에서 제공하는 **기본 큐 유형**으로, **높은 처리량과 낮은 지연 시간**을 제공함.

## 특징

* Standard Queue는 메시지의 **순서 보장을 제공하지 않으며**, 메시지의 **중복 수신 가능성을 허용**함.
* **높은 처리량과 확장성을 제공**하므로, 대규모의 비동기 메시지 전송이 필요한 애플리케이션에 적합함.

### 최고의 처리량 (High Throughput)

* Standard Queue는 거의 **무제한의 메시지를 초당 처리**할 수 있음.
* **병렬로 많은 수의 메시지를 보내고 받을 수 있어 높은 트래픽을 처리**할 수 있음.

### 적어도 한 번의 전달 (At-Least-Once Delivery)

* 메시지는 적어도 **한 번 이상 전달**됨.
* **드물게 중복 메시지가 발생**할 수 있음.

### 메시지 순서 비보장 (Best-Effort Ordering)

* 메시지 순서가 보장되지 않음.
* 메시지가 도착하는 순서가 전송한 순서와 다를 수 있음.

## 장점
* **확장성**  
자동으로 확장되어 높은 트래픽을 처리할 수 있음.
* **가용성**  
메시지가 여러 **가용 영역에 복제되어 높은 내구성을 제공**함.
* **저렴한 비용**  
사용한 만큼만 비용을 지불하므로 경제적임.

## 단점
* **메시지 순서 보장 안 됨**  
순서가 중요한 경우에는 FIFO Queue를 사용하는 것이 좋음.
* **중복 메시지 발생 가능성**  
메시지 중복을 처리할 수 있는 로직이 필요함.

## 아키텍처

### 메시지 생성 (Producing Messages)

* 애플리케이션은 메시지를 SQS Standard Queue에 전송함.
* 이는 **AWS SDK나 API**를 통해 이루어짐.

### 메시지 소비 (Consuming Messages)

* 애플리케이션 또는 서비스는 SQS 큐에서 메시지를 읽어옴.
* 메시지를 가져온 후, **지정된 시간 동안 다른 소비자에게 보이지 않도록 하는 Visibility Timeout을 설정**함.

## Use Case

* **비동기 작업 처리**  
백엔드 작업을 비동기적으로 처리하여 사용자 응답 시간을 줄임.
* **분산 시스템의 메시지 브로커**  
마이크로서비스 간의 메시지 전달을 비동기적으로 처리하여 시스템의 확장성과 유연성을 높임.
* **일괄 처리 시스템**  
대량의 데이터를 처리할 때 큐를 사용하여 작업을 여러 워커 인스턴스로 분배함.

# FIFO Queue

* Queue에 제공되는 메시지의 순서를 보장함.
* 배치 처리가 되지 않을 때 초당 300개의 메시지로 처리량(Throughput)이 제한 됨.
* 중복 메시지를 제거하기 때문에 Consumer에게 딱 한 번만 메시지가 전달 됨.

## 특징

### Exactly-once Processing  
메시지가 정확히 한 번 전달되고, 중복되지 않음.

### First-In-First-Out Delivery  
메시지가 큐에 넣어진 순서대로 전달됨.

### Message Group ID  
메시지를 그룹화하여 같은 그룹의 메시지들이 순서대로 처리되도록 보장함.

### Lower Throughput  
Standard Queue보다 처리량이 낮지만, 순서와 중복되지 않음을 보장함.

## 순서 보장 방법

### Message Group ID  
* 메시지에 **그룹 ID를 지정하여 같은 그룹에 속한 메시지들이 순서대로 처리**되도록 함.  
* 예를 들어, 사용자 ID를 Message Group ID로 사용하면, 해당 사용자의 모든 메시지가 순서대로 처리됨.
* Group ID를 사용하지 않으면, 하나의 Consumer에 의해 모든 메시지가 순서대로 처리됨.
* Group ID는 Kinesis 의 Partition Key와 유사하게 작동함.

### Deduplication ID  
* 메시지 중복 방지를 위해 메시지의 중복 제거 ID를 사용함.  
* 중복 제거 ID는 메시지를 중복없이 정확히 한 번만 처리되도록 함.