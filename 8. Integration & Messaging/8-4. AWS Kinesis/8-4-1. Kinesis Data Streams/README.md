# [Kinesis Data Streams](https://aws.amazon.com/ko/kinesis/data-streams/)

## <img src = "https://github.com/LeeWooJung/AWS-SAA-C03/assets/31682438/53c40c93-5589-4108-9748-569f454b1098" width = "30" height = "30"> Kinesis Data Streams

* Amazon Kinesis Data Streams는 **대규모 스트리밍 데이터를 실시간으로 수집하고 처리**할 수 있는 AWS 서비스임.  
* 이를 통해 **클릭스트림 데이터, 로그 데이터, 소셜 미디어 데이터** 등을 실시간으로 처리할 수 있음.
* 데이터는 1일~365일 동안 보관됨.
* 입력된 데이터를 다시 입력된 것처럼 처리할 수 있음(reprocess, replay).
* 데이터가 Kinesis에 입력되면, 삭제되지 않음(immutability).
* 동일 partition을 공유하는 데이터는 같은 shard로 입력됨(ordering).

## 기능

### 실시간 데이터 처리  
데이터가 수집되는 즉시 처리할 수 있음.

### 확장성  
데이터 처리 요구에 맞게 쉽게 확장 가능함.

### 내결함성  
데이터를 여러 가용 영역(AZ)에 복제하여 내결함성을 제공함.

### Capacity Mode
Kinesis Data Streams는 **두 가지 용량 모드**를 제공.

* **On-demand Mode**  
    * 사용자가 스트림의 용량을 관리할 필요 없이 지난 30일간의 throughput peak을 관찰하고 **자동으로 확장 및 축소**됨.  
    * 데이터 처리량이 변동이 큰 경우에 적합함.
    * Default: 4MB/s or 4,000 records per second.
    * 시간 당 stream이나, GB당 data in/out으로 요금이 결정됨.

* **Provisioned Mode**  
    * 사용자가 API를 이용하여 **샤드 수를 직접 관리**하여 처리량을 설정함.  
    * 각 샤드는 1MB/s in, 2MB/s out를 기본으로 가지고 있음.
    * 예측 가능한 트래픽 패턴이 있는 경우에 적합함.
    * 시간 당 provision 된 shard의 수에 따라 비용을 지불함.

### Security

* **데이터 암호화**  
    * 서버 측에서 데이터 암호화가 가능함.  
    * 기본적으로 **AWS KMS**를 사용하여 데이터를 암호화할 수 있음.
    * HTTPS endpoint를 이용하여 **in flight Encryption**할 수 있음.
    * Client side에서 암호화를 진행할 수 있지만, 어려움.

* **네트워크 보안**  
    * **Amazon VPC와 통합**되어 스트림에 대한 네트워크 트래픽을 제어할 수 있음.
    * CloudTrail을 이용해서 API Call을 확인할 수 있음.

* **IAM 역할**   
    * AWS Identity and Access Management(IAM)를 사용하여 스트림에 대한 액세스를 제어할 수 있음.  
    * **사용자, 그룹, 역할에 따른 세부 권한을 설정**할 수 있음.

* **액세스 정책**  
    * 스트림 수준에서 접근 정책을 정의하여 특정 사용자가 특정 작업을 수행할 수 있도록 허용하거나 거부할 수 있음.

## 아키텍처

### 데이터 생산자  
* **데이터를 스트림에 기록하는 애플리케이션 또는 디바이스**임.  
* 예를 들어, 웹 서버, 모바일 앱, AWS SDK, Kinesis Producer Library(KPL), Kinesis Agent 등이 있음.

### 샤드  
* 스트림 내에서 **데이터가 분할되어 저장되는 기본 단위**임.  
* 각 샤드는 **쓰기 및 읽기 용량**을 가짐.  
* 샤드를 추가하여 스트림의 처리량을 확장할 수 있음.

### 데이터 레코드  
* 스트림에 기록되는 개별 데이터 단위임.  
* 각 레코드는 **데이터 본문과 파티션 키**로 구성됨.

### 데이터 소비자  
* 스트림에서 데이터를 읽어 처리하는 애플리케이션임.  
* 예를 들어, AWS Lambda, Amazon EC2 인스턴스 등이 있음.

### 샤드 리더  
* 스트림의 특정 **샤드에서 데이터를 읽어오는 소비자 애플리케이션의 구성 요소**임.

### Example

![kinesis data streams architecture](https://github.com/LeeWooJung/AWS-SAA-C03/assets/31682438/9d794bf5-5fae-4232-b2df-8815cc2d2914)


## Use Case

### 실시간 로그 분석  
애플리케이션 로그를 실시간으로 수집하고 분석하여 즉시 대응할 수 있음.

### 클릭스트림 분석  
웹사이트 방문자의 클릭스트림 데이터를 실시간으로 분석하여 사용자 행동을 이해하고 마케팅 전략을 최적화할 수 있음.

### IoT 데이터 처리  
IoT 디바이스에서 수집된 데이터를 실시간으로 처리하고 분석하여 실시간 모니터링 및 제어를 가능하게 함.

### 금융 거래 분석  
금융 거래 데이터를 실시간으로 분석하여 이상 거래를 탐지하고 신속하게 대응할 수 있음.

## 장점

### 높은 처리량  
대규모 데이터를 실시간으로 처리할 수 있음.

### 유연한 확장성  
필요에 따라 쉽게 확장 가능함.

### 강력한 내결함성  
데이터를 여러 가용 영역에 복제하여 높은 가용성을 제공함.

### 실시간 분석  
실시간 데이터 분석을 통해 빠른 의사결정이 가능함.

## 단점

### 복잡성  
스트리밍 데이터 파이프라인을 설정하고 관리하는 데 다소 복잡함.

### 비용  
대규모 데이터를 실시간으로 처리하는 경우 비용이 발생할 수 있음.

## Summary
* Amazon Kinesis Data Streams는 **대규모 데이터를 실시간으로 수집하고 처리할 수 있는 스트리밍 데이터 플랫폼**임.  
* On-demand Mode와 Provisioned Mode 두 가지 용량 모드를 제공하며, 데이터 암호화, 네트워크 보안, IAM 역할 등 다양한 보안 기능을 지원함.  
* 주요 사용 사례로는 실시간 로그 분석, 클릭스트림 분석, IoT 데이터 처리, 금융 거래 분석 등이 있음.  
* 높은 처리량과 유연한 확장성, 강력한 내결함성을 제공하지만, 설정 및 관리의 복잡성과 비용이 발생할 수 있음.