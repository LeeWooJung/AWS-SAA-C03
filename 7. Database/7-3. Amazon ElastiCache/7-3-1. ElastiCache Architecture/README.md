# ElastiCache Architecture

## 데이터베이스 캐싱(DB Cache)

* 데이터베이스 캐싱은 성능을 향상시키고 데이터베이스에 대한 부하를 줄이는 데 사용됨.  
* 자주 조회되는 데이터를 메모리 내에 저장하여 데이터베이스의 직접 조회를 피할 수 있음.

### Architecture

* **데이터 소스**  
    * 데이터베이스(예: Amazon RDS, Aurora 등)
    * 데이터는 기본 데이터베이스에서 관리.

* **ElastiCache 계층**  
    * **캐시 노드**  
    Redis 또는 Memcached 인스턴스가 자주 접근되는 데이터를 저장.
    * **다중 AZ 배포**  
    고가용성을 위해 여러 가용 영역에 걸쳐 배포.
    * **읽기 복제본**  
    읽기 작업을 확장할 수 있는 Redis 복제본.

* **애플리케이션 계층**  
    * 애플리케이션 서버는 데이터베이스에 직접 접근하기 전에 ElastiCache를 조회.
    * 데이터가 캐시에 없으면, 데이터베이스에서 데이터를 조회하고 이를 캐시에 저장.

### Data Flow

1. **캐시 조회**  
클라이언트가 애플리케이션 서버를 통해 요청을 보냄.
2. **캐시 히트**  
요청된 데이터가 캐시에 존재하면, ElastiCache에서 데이터를 반환.
3. **캐시 미스**  
요청된 데이터가 캐시에 없으면, 애플리케이션 서버는 데이터베이스에 요청을 보냄.  
데이터베이스에서 데이터를 조회한 후 캐시에 저장하고 클라이언트에 반환(Lazy Loading).

### Architecture Figure

![DB Cache architecture](https://github.com/LeeWooJung/AWS-SAA-C03/assets/31682438/0e9a75a5-0fc7-4e00-8f50-54d89178b06a)


## 사용자 세션 저장(User Session Store)

* **사용자 세션 데이터**를 ElastiCache에 저장하면 세션 관리를 효율적으로 수행할 수 있음.  
* 이는 웹 애플리케이션에서 중요한 성능 향상을 제공함.

### Architecture

* **애플리케이션 서버**  
    * 웹 애플리케이션 또는 API 서버가 사용자 요청을 처리.
    * 세션 데이터를 관리해야 함(예: 로그인 상태, 사용자 설정 등).

* **ElastiCache 계층**  
    * **세션 데이터 저장**  
    **Redis**를 사용하여 세션 데이터를 저장.  
    Redis는 데이터 지속성과 고가용성을 제공.
    * **다중 AZ 배포**  
    고가용성을 위해 여러 가용 영역에 걸쳐 배포.
    * **읽기 복제본**  
    읽기 작업을 확장할 수 있는 Redis 복제본.

* **클라이언트**  
    * 웹 브라우저 또는 모바일 앱이 애플리케이션 서버와 상호 작용.
    * 세션 데이터를 저장하고 검색함.

### Data Flow

1. **세션 생성**  
사용자가 로그인하면 애플리케이션 서버는 세션 데이터를 생성하고 이를 ElastiCache에 저장.

2. **세션 조회**  
사용자가 요청을 보낼 때마다 애플리케이션 서버는 ElastiCache에서 세션 데이터를 조회.

3. **세션 갱신**  
사용자 활동에 따라 세션 데이터가 변경되면, 애플리케이션 서버는 ElastiCache에 저장된 세션 데이터를 갱신.

4. **세션 종료**  
사용자가 로그아웃하면, 애플리케이션 서버는 ElastiCache에서 해당 세션 데이터를 삭제.

### Architecture Figure

![User Session architecture](https://github.com/LeeWooJung/AWS-SAA-C03/assets/31682438/8ffe1489-34fe-465a-a418-03fd820a42c0)


## DB Cache vs User Session Store

|**기능**|**DB Cache**|**User Session Store**|
|:---|:---|:---|
|**사용**|자주 조회되는 데이터의 읽기 성능 향상|사용자 세션 데이터 관리|
|**데이터 유형**|읽기 전용 데이터, 자주 변경되지 않는 데이터|읽기/쓰기 데이터, 자주 변경되는 데이터|
|**캐시 만료**|캐시 무효화 전략 필요|세션 만료 전략 필요|
|**고가용성**|다중 AZ 배포, 읽기 복제본|다중 AZ 배포, 읽기 복제본|
|**성능 요구 사항**|빠른 읽기 성능, 데이터 일관성 중요|빠른 읽기 및 쓰기 성능, 데이터 일관성 중요|