# Streaming Process

Amazon DynamoDB 스트리밍 프로세스는 **테이블에 대한 데이터 수정 이벤트(삽입, 업데이트, 삭제)를 실시간으로 캡처**하고 이를 다른 AWS 서비스와 통합할 수 있도록 해주는 기능임.  

이를 통해 **데이터 변화를 기반으로 한 다양한 애플리케이션을 구축**할 수 있음.

## 스트림 활성화

DynamoDB 스트리밍을 사용하려면 먼저 **테이블에서 스트림을 활성화**해야 함.  

스트림이 활성화되면 DynamoDB는 테이블의 각 **항목에 대한 수정 이벤트를 스트림에 기록**함.

## 스트림 데이터 구조

DynamoDB 스트림은 변경 로그를 순차적으로 기록함. 

### 이벤트 ID  
이벤트를 고유하게 식별하는 ID임.

### 이벤트 유형  
INSERT, MODIFY, REMOVE의 세 가지 유형이 있음.

### 테이블 이름  
이벤트가 발생한 테이블의 이름임.

### 변경된 항목의 이미지  
이전 이미지와 새로운 이미지가 포함될 수 있음.

## 스트림 처리

DynamoDB 스트림을 처리하려면 **스트림 데이터에서 이벤트를 읽어와야 함**.  

이를 위해 **AWS Lambda와 Amazon Kinesis Data Streams**를 주로 사용함.

### AWS Lambda와 통합

* **Lambda 함수 생성**  
DynamoDB 스트림을 처리할 Lambda 함수를 생성함.

* **스트림과 Lambda 연결**  
DynamoDB 스트림을 Lambda 함수의 이벤트 소스로 설정함.

* **이벤트 처리**  
Lambda 함수는 스트림 이벤트를 수신하고 처리 로직을 수행함.  
예를 들어, 데이터 변화를 다른 데이터베이스에 반영하거나 알림을 발송할 수 있음.

## Amazon Kinesis Data Streams와 통합

* **Kinesis 스트림 생성**  
DynamoDB 스트림 데이터를 처리할 Kinesis 스트림을 생성함.

* **Kinesis 스트림과 연결**  
DynamoDB 스트림을 Kinesis 스트림과 연결하여 스트림 데이터를 Kinesis로 전송함.

* **Kinesis 애플리케이션**  
Kinesis 스트림에서 데이터를 읽어오는 애플리케이션을 구축하여 데이터를 실시간으로 처리함.

## 스트림 사용 사례

### 실시간 반응
실시간으로 변경되는 데이터에 반응할 수 있음.

### 데이터 복제  
DynamoDB **테이블 간 데이터 복제**를 통해 다중 리전 배포를 실현할 수 있음.

### 분석 및 모니터링  
데이터 변화를 실시간으로 분석하여 **대시보드 업데이트나 모니터링 알림을 제공**할 수 있음.

### 캐싱  
자주 액세스되는 데이터를 인메모리 캐시로 전송하여 읽기 성능을 향상시킬 수 있음.

### 이벤트 기반 아키텍처  
데이터 변경 이벤트를 기반으로 다른 마이크로서비스를 트리거하여 비동기식 워크플로우를 구현할 수 있음.

## Architecture Example

![DynamoDB Streams Architecture](https://github.com/user-attachments/assets/2a69e3f1-ddac-4a9d-875a-2f2d8bd9f2b0)


## 장점

### 실시간 처리  
데이터 변화를 실시간으로 캡처하고 처리할 수 있음.

### 확장성  
AWS Lambda와 Kinesis와의 통합으로 확장성이 뛰어남.

### 유연성  
다양한 사용 사례에 적용 가능함.

## 단점

### 복잡성  
스트림과 Lambda 또는 Kinesis의 설정 및 관리는 다소 복잡할 수 있음.

### 비용  
스트림 활성화와 데이터 처리에 따른 추가 비용이 발생할 수 있음.

## DynamoDB Streams vs. Kinesis Data Streams

DynamoDB Streams와 Kinesis Data Streams는 둘 다 데이터 스트리밍을 위한 AWS 서비스지만, 각각의 목적과 사용 사례가 다름.

### DynamoDB Streams

* **목적**

    **DynamoDB 테이블의 데이터 변경 이벤트를 실시간으로 캡처하고 처리하기 위해 설계**되었음.

* **특징**

    * **이벤트 유형**  
    데이터 변경 이벤트(INSERT, MODIFY, REMOVE)를 캡처함.
    * **통합성**  
    AWS Lambda와의 긴밀한 통합으로 이벤트 기반 아키텍처를 쉽게 구현할 수 있음.
    * **사용 사례**  
    데이터 복제, 트리거 기반 워크플로우, 실시간 데이터 처리 등.

* **장점**

    * **쉬운 설정**  
        DynamoDB 테이블에서 스트림을 활성화하는 것이 간단함.
    * **자동 스케일링**  
        DynamoDB와 함께 자동으로 확장됨.
    * **무중단 운영**  
        테이블의 읽기/쓰기 작업에 영향을 주지 않음.

* **단점**

    * **한정된 사용 사례**  
        DynamoDB 테이블과 관련된 데이터 변경 이벤트 처리에 주로 사용됨.
    * **제한된 커스텀 처리**  
        커스텀 스트림 처리 기능이 제한적임.

### Kinesis Data Streams

* **목적**

    대규모 데이터 스트리밍 애플리케이션을 구축하기 위해 설계되었음.

* **특징**

    * **범용성**  
        **다양한 데이터 스트리밍 시나리오**(로그, IoT 데이터, 애플리케이션 이벤트 등)에 사용 가능함.
    * **샤드(Shard)**  
        스트림 내 샤드 단위로 데이터가 분할되어 병렬로 처리할 수 있음.
    * **처리 애플리케이션**  
        Kinesis Client Library (KCL)을 사용하여 스트림 데이터를 소비할 수 있음.

* **장점**

    * **유연성**  
        다양한 데이터 소스와 사용 사례에 적용 가능함.
    * **고성능**  
        높은 처리량과 저지연성을 제공함.
    * **커스텀 처리**  
        사용자 정의 스트림 처리 애플리케이션을 작성할 수 있음.

* **단점**

    * **복잡성**  
        설정과 관리가 복잡할 수 있음.
    * **비용** 
        대규모 데이터 스트림의 경우 비용이 증가할 수 있음.

### 비교

|특성|DynamoDB Streams|Kinesis Data Streams|
|:---|:---:|:---:|
|목적|DynamoDB 테이블의 변경 이벤트 캡처|대규모 데이터 스트리밍|
|통합성|AWS Lambda, DynamoDB Stream Kinesis Adapter와 긴밀한 통합|다양한 데이터 소스와 처리 애플리케이션(AWS Lambda, Kinesis Data Analytics, Kinesis Data Firehose, AWS Glue Streaming ETL 등)|
|유연성|제한된 사용|범용적인 스트리밍 데이터 처리|
|성능|자동 스케일링, 쉬운 설정|높은 처리량, 저지연성|
|복잡성|쉬운 설정과 관리|복잡한 설정과 관리|
|비용|DynamoDB 사용 비용에 포함|데이터 처리량에 따른 추가 비용|
|데이터 저장|24 시간|1년|
|Consumer|제한된 수의 Consumer|많은 수의 Consumer|

## Summary

Amazon DynamoDB의 스트리밍 프로세스는 **데이터 변화를 실시간으로 캡처하여 다양한 애플리케이션과 통합**할 수 있는 강력한 기능임.  

이를 통해 **데이터 복제, 실시간 분석, 이벤트 기반 아키텍처 등 다양한 시나리오를 구현**할 수 있음.  

스트림 데이터는 AWS Lambda와 Kinesis Data Streams를 사용하여 효율적으로 처리할 수 있음.