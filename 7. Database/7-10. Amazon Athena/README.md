# [Amazon Athena](https://docs.aws.amazon.com/athena/latest/ug/what-is.html)

## <img src = "https://github.com/user-attachments/assets/009e601d-a36a-466b-9496-b34abf8a5c2b" width = "25" height = "25"> Amazon Athena

Amazon Athena는 **S3에 저장된 데이터를 표준 SQL을 사용하여 분석할 수 있는 인터랙티브 쿼리 서비스**임.  

**서버리스 아키텍처**로 동작하며, **인프라를 관리할 필요 없이** 데이터를 빠르게 분석할 수 있음.

## 특징

### 서버리스 아키텍처

Athena는 서버리스로 동작하여 인프라를 관리할 필요 없이(운영 오버헤드 감소) 데이터 쿼리를 실행할 수 있음.

### 표준 SQL 지원

ANSI SQL을 지원하여 기존 SQL 지식을 활용할 수 있음.

### 데이터 소스 통합

S3에 저장된 다양한 형식의 데이터를 분석할 수 있음. 

**CSV, JSON, ORC, Avro, Parquet 등 다양한 데이터 형식을 지원**함.

### 빠른 분석 속도

S3에 저장된 **대용량 데이터를 빠르게 분석**할 수 있음. 

내부적으로 **Presto 엔진을 사용하여 쿼리를 실행**함.

### Pay-as-you-go

사용한 **쿼리 실행 시간에 따라 비용이 청구**되며, 저장된 데이터 양에 따라 비용이 발생하지 않음.

## Use case

* **로그 분석**  

    애플리케이션 로그를 S3에 저장하고 Athena를 사용하여 실시간으로 분석할 수 있음.

* **데이터 레이크 분석**

    S3에 저장된 **데이터 레이크를 쿼리하여 비즈니스 인사이트를 도출**할 수 있음.

* **Ad-hoc 쿼리**

    즉석에서 필요한 데이터를 분석하고 결과를 얻을 수 있음.

* **데이터 탐색**  
    
    S3에 저장된 다양한 데이터를 탐색하고 패턴을 발견할 수 있음.

## 장점

### 서버리스 아키텍처

**서버를 관리할 필요 없이 사용자가 쿼리만 작성**하면 됨.

인프라 관리 부담이 없으므로 운영이 간편함.

### 표준 SQL 지원

ANSI SQL을 지원하여 기존 SQL 지식을 활용할 수 있음.

**복잡한 쿼리도 쉽게 작성**할 수 있음.

### 빠른 쿼리 성능

Presto 쿼리 엔진을 사용하여 **대용량 데이터에 대해 빠른 응답 속도를 제공**함.

S3에 저장된 데이터를 효율적으로 분석할 수 있음.

### 다양한 데이터 형식 지원

CSV, JSON, ORC, Parquet 등 다양한 형식의 데이터를 지원함.

데이터 준비 과정이 간소화됨.

### 비용 효율성

**Pay-as-you-go 방식으로 사용한 만큼만 비용을 지불**함.

저장된 데이터 양에 따라 비용이 발생하지 않음.

### 손쉬운 데이터 통합

**S3에 저장된 데이터를 직접 쿼리할 수 있어 데이터 이동이 필요 없음**.

**다른 AWS 서비스와의 연동이 용이**함.

보통 **Amazon Quicksight**와 통합되어 reporting 혹은 dashboards에 사용됨.

## 단점

### 대규모 데이터 처리의 한계

**매우 대규모 데이터 셋의 경우 쿼리 성능이 저하**될 수 있음.

복잡한 쿼리의 경우 실행 시간이 길어질 수 있음.

### 데이터 준비 작업 필요

데이터가 잘 구조화되어 있지 않으면 **스키마 정의 및 데이터 정리가 필요**함.

초기 설정에 시간이 걸릴 수 있음.

### 비용 예측의 어려움

쿼리 실행 시간에 따라 비용이 달라지므로 **비용 예측이 어려울 수 있음**.

쿼리 최적화가 필요함.

### 고급 SQL 기능의 제한

일부 고급 SQL 기능이나 복잡한 트랜잭션 처리는 제한적임.

모든 SQL 기능을 지원하지 않을 수 있음.

## 비용

* **쿼리 실행 비용**

    Amazon Athena의 **비용은 쿼리한 데이터의 양**(스캔한 데이터) 기준으로 청구됨.

    현재 비용은 스캔한 데이터 **1TB당 $5**임.

* **비용 절감 방법**

    **데이터 형식을 효율적으로 변환**하여 스캔 데이터를 줄일 수 있음 (예: Parquet, ORC).

    **필요 없는 데이터 컬럼을 제외**하여 쿼리 비용을 절감할 수 있음.

    파티셔닝을 통해 쿼리 범위를 제한하여 비용을 줄일 수 있음.

## Summary

Amazon Athena는 데이터 분석을 쉽게 할 수 있도록 도와주는 강력한 도구임.  

**인프라 관리 없이 SQL 쿼리를 통해 S3에 저장된 데이터를 빠르게 분석**할 수 있음으로써 데이터 분석 작업의 효율성을 크게 향상시킬 수 있음.