# [Amazon GuardDuty](https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html)

## <img src = "https://github.com/user-attachments/assets/df1dd71d-9813-4829-a6c7-019dc7d64786" width = "25" height = "25"> Amazon GuardDuty

Amazon GuardDuty는 **AWS 환경에서 발생하는 로그 데이터를 분석하여 보안 위협을 탐지하는 서비스**임. 

이는 AWS 환경에서 **잠재적인 보안 위협과 비정상적인 활동을 실시간으로 모니터링하고 식별**함으로써, 보안 위협에 대한 대응을 빠르게 할 수 있도록 지원함.

이 서비스는 다양한 데이터 소스(예: AWS CloudTrail 로그, VPC 흐름 로그, DNS 쿼리 로그)를 사용하여 **악성 활동, 비정상적인 행위, 침해 시도 등을 식별하고, 이를 기반으로 경고를 생성**함.

한 번의 클릭으로 실행 가능하며, Software를 설치할 필요가 없음.

위협을 탐지했을 때 **EventBridge**를 호출하여 이벤트를 전송할 수 있음. **EventBridge Rules**를 사용하여 **AWS Lambda** 혹은 **SNS**로 전송할 수 있음.

**CryptoCurrency** 공격에 대해 보호할 수 있음.

## 특징

### 자동화된 위협 탐지

기계 학습, 통계적 분석, 데이터베이스 기반의 위협 인텔리전스를 사용하여 위협을 자동으로 탐지함.

### 다양한 데이터 소스

**CloudTrail, VPC 흐름 로그, DNS 쿼리 로그 등 다양한 AWS 로그 데이터를 분석하여 위협을 탐지**함.

* **CloudTrail Events Logs**

    unusual API calls, unauthorized deployments를 탐지함.

    * CloudTrail Management Events: VPC Subnet 생성, Trail 생성 등.

    * CloudTrail S3 Data Events: Get Object, List Object, Delete Object 등

* **VPC Flow Logs**

    unusual internet traffic, unusual IP address 등을 탐지함.

* **DNS Logs**

    DNS Query 내에서 인코딩된 데이터를 보내는 손상된 EC2 Instance 등을 탐지함.

* **Optional Features**

    EKS Audit Logs, RDS & Aurora, EBS, Lambda, S3 Data Events 등을 탐지함.

### 실시간 경고

탐지된 위협에 대한 **실시간 경고를 제공하여 신속한 대응을 지원**함.

### 사용자 친화적인 대시보드

웹 콘솔을 통해 경고를 시각적으로 모니터링하고, 경고에 대한 세부 정보를 확인할 수 있음.

### 위협 인텔리전스 통합

업계의 최신 위협 인텔리전스를 통합하여 알려진 위협을 탐지함.

## 구성요소

* **로그 데이터**

    **CloudTrail, VPC 흐름 로그, DNS 쿼리 로그 등 다양한 소스에서 수집된 로그 데이터**임.

* **위협 탐지 엔진**

    기계 학습 모델과 통계 분석을 사용하여 로그 데이터를 분석하고 위협을 식별함.

* **경고**(Alert)

    탐지된 위협에 대한 알림으로, 보안 경고를 생성하여 사용자에게 알려줌.

* **대시보드**

    GuardDuty 콘솔에서 **경고를 시각적으로 모니터링하고, 탐지된 위협에 대한 정보를 확인할 수 있는 웹 인터페이스**임.

* **위협 인텔리전스**

    최신 보안 위협 정보를 제공하여 알려진 위협을 식별하고 대응할 수 있도록 지원함.

## 아키텍처

### 데이터 수집

AWS 계정에서 CloudTrail, VPC 흐름 로그, DNS 쿼리 로그 등을 수집함.

### 데이터 분석

수집된 로그 데이터를 GuardDuty의 위협 탐지 엔진에서 분석함. 

기계 학습과 통계적 분석을 사용하여 비정상적인 패턴과 활동을 식별함.

### 위협 식별

분석 결과를 바탕으로 잠재적인 보안 위협을 탐지하고, 경고를 생성함.

### 경고 전달

탐지된 위협에 대한 경고를 사용자의 AWS Management Console, SNS 알림 등을 통해 전달함.

### 대시보드 확인

GuardDuty 콘솔에서 탐지된 위협을 모니터링하고, 세부 정보를 확인함.

## 장점

* **자동화된 위협 탐지**

    기계 학습과 데이터 분석을 통해 위협을 **자동으로 탐지**하므로, 수동적인 모니터링이 필요 없으며, 신속하게 대응할 수 있음.

* **실시간 경고**

    위협을 실시간으로 탐지하여 빠르게 대응할 수 있도록 도움을 줌.

* **다양한 데이터 소스**

    CloudTrail, VPC 흐름 로그, DNS 쿼리 로그 등 **다양한 로그 데이터를 사용하여 포괄적인 보안 모니터링**을 제공함.

* **비용 효율적**

    **필요에 따라 사용량에 따라 요금이 청구되므로, 비용을 효율적으로 관리**할 수 있음.

* **위협 인텔리전스 통합**

    최신 위협 인텔리전스를 통합하여 알려진 위협에 대한 탐지 능력을 향상시킴.

## 단점

* **위협 분석의 한계**

    GuardDuty는 특정 패턴에 기반하여 위협을 탐지하므로, **새로운 유형의 위협이나 특이한 공격 패턴을 탐지하는 데 한계**가 있을 수 있음.

* **경고의 오탐 및 누락**

    자동화된 시스템으로 인해 경고의 오탐(false positives) 또는 누락(false negatives)이 발생할 수 있음.

* **초기 설정 필요**

    GuardDuty를 초기 설정하고 구성하는 데 일정한 시간이 필요할 수 있음.

## Use case

* **계정 침해 탐지**

    비정상적인 API 호출이나 계정 침해 시도를 탐지하여 대응함.

* **네트워크 공격 탐지**

    VPC 흐름 로그를 분석하여 네트워크에서 발생하는 비정상적인 활동을 탐지함.

* **DNS 공격 탐지**

    DNS 쿼리 로그를 분석하여 도메인 기반 공격이나 악성 트래픽을 탐지함.

* **보안 모니터링**

    전체 AWS 환경의 보안 상태를 모니터링하고, 보안 문제를 신속하게 파악하고 대응함.

## Summary

Amazon GuardDuty는 AWS에서 제공하는 실시간 위협 탐지 서비스임. 

**CloudTrail, VPC 흐름 로그, DNS 쿼리 로그 등 다양한 로그 데이터를 분석하여 보안 위협을 자동으로 탐지**하고, 실시간으로 경고를 제공함. 

이를 통해 사용자는 애플리케이션 및 인프라에서 발생할 수 있는 **잠재적인 보안 문제를 신속하게 식별하고 대응**할 수 있음. 

자동화된 위협 탐지, 다양한 데이터 소스 지원, 최신 위협 인텔리전스 통합 등의 장점을 제공하며, 보안 모니터링과 침해 탐지에 효과적임.