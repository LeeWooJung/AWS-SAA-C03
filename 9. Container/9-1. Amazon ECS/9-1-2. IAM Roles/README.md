# IAM Roles

## EC2 Instance Profile

EC2 Instance Profile은 **EC2 인스턴스가 AWS 리소스에 액세스할 수 있도록 하는 역할**임.  

이를 통해 인스턴스에 부여된 권한을 통해 **S3 버킷, DynamoDB 테이블, SNS 주제 등 다양한 AWS 서비스에 액세스**할 수 있음.  

### 특징

* **설정**  
    * EC2 인스턴스를 시작할 때 IAM 역할을 연결하여 설정함.  
    * 인스턴스 프로필은 이러한 역할의 컨테이너 역할을 함.

* **권한 부여**  
    * EC2 인스턴스에서 실행되는 애플리케이션이 필요한 AWS 리소스에 접근할 수 있도록 권한을 부여함.

* **보안**  
    * 하드코딩된 자격 증명 대신 **IAM 역할을 사용하여 보안을 강화**함.

### 과정

* **ECS Agent**에 의해 사용됨.
* ECS Service에 API Call을 보냄.
* CloudWath로 Container의 logs를 보냄.
* ECR로부터 Docker image를 불러옴.

## ECS Task Role

ECS Task Role은 **ECS 작업(Task)에서 실행되는 컨테이너가 AWS 리소스에 액세스할 수 있도록 하는 역할**임.  

Task Role은 Task에 직접 정의 됨.  

각 ECS 작업(Task)에 **개별적으로 IAM 역할을 할당**하여 필요한 **권한을 세밀하게 제어**할 수 있음.

### 특징

* **세밀한 권한 제어**  
    * 각 작업에 대해 **개별적으로 IAM 역할을 할당**하여 권한을 세밀하게 제어함.

* **보안**  
    * 컨테이너가 필요한 **최소 권한**만을 가질 수 있도록 하여 보안을 강화함.

* **유연성**  
    * 여러 작업이 동일한 인스턴스에서 실행되더라도 각 작업은 고유한 역할을 가질 수 있음.

## 차이점

### 적용 범위

* **EC2 Instance Profile**  
    * **EC2 인스턴스 전체에 적용**됨.  
    * 인스턴스에서 실행되는 모든 작업과 애플리케이션이 동일한 권한을 가짐.

* **ECS Task Role**  
    * **개별 ECS 작업에 적용**됨.  
    * 작업마다 다른 권한을 부여할 수 있음.

### 사용 시점

* **EC2 Instance Profile**  
    EC2 인스턴스가 시작될 때 할당됨.
* **ECS Task Role**  
    ECS 작업이 시작될 때 할당됨.

### 권한 범위

* **EC2 Instance Profile**  
    인스턴스 내의 모든 작업과 애플리케이션이 동일한 권한을 공유함.
* **ECS Task Role**  
    개별 작업이 고유한 권한을 가질 수 있음.

### 보안 수준

* **EC2 Instance Profile**  
    인스턴스 내의 모든 애플리케이션이 동일한 권한을 가지므로 **보안 관리가 상대적으로 덜 세밀**함.
* **ECS Task Role**  
    작업별로 다른 권한을 부여할 수 있어 세밀한 보안 관리가 가능함.

## Summary
EC2 Instance Profile과 ECS Task Role은 **각각 인스턴스 및 작업 수준에서 AWS 리소스에 대한 접근 권한을 관리하는 중요한 도구**임.  

**인스턴스 수준에서 일관된 권한 관리**가 필요할 때는 EC2 Instance Profile을 사용하고, **작업별로 세밀한 권한 관리**가 필요할 때는 ECS Task Role을 사용하는 것이 좋음.  

이러한 역할을 통해 AWS 리소스에 대한 안전하고 효율적인 접근을 관리할 수 있음.