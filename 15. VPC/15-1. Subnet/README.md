# [Subnet(IPv4)](https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/configure-subnets.html)

## <img src = "https://github.com/user-attachments/assets/4085f971-a167-490b-97b9-a8f54ef6e769" width = "25" height = "25"> Subnet

서브넷은 **VPC의 IP 주소 범위 안에 포함되는 더 작은 네트워크 단위**로, VPC의 네트워크를 세분화하고 논리적으로 분리할 수 있음. 

서브넷을 통해 **애플리케이션을 격리하고, 보안 정책을 적용하며, 네트워크 트래픽을 효과적으로 관리**할 수 있음.

## 특징

### CIDR 블록

서브넷은 **VPC의 IP 주소 공간 내에서 고유한 CIDR**(Classless Inter-Domain Routing) 블록을 가짐. 

예를 들어, VPC의 CIDR 블록이 10.0.0.0/16이라면 서브넷은 10.0.1.0/24와 같은 하위 CIDR 블록을 가질 수 있음.

Subnet의 IP를 할당할 때 **5개의 IP 주소**는 사용하지 못함. AWS에서 이미 할당(첫 4개, 마지막 1개의 IP 주소)했기 때문.


* **Example**

    Subnet의 CIDR Block이 10.0.0.0/24라면, AWS에 의해 이미 할당된 IP주소는 다음과 같음.

    * 10.0.0.0 : Network 주소
    * 10.0.0.1 : VPC Router에서 사용하는 주소.
    * 10.0.0.2 : Amazon에서 제공된 DNS를 위한 주소.
    * 10.0.0.3 : 미래에 AWS에서 사용하기 위한 주소.
    * 10.0.0.255 : Network Broad Cast를 위한 주소. VPC에서는 Broda Cast가 불가능하여 사용할 수 없음.

* **만약 29개의 IP 주소가 필요하면**

    /**27**은 사용하지 못함. 
    
    /27은 **32개의 IP 주소**를 사용할 수 있을 것 같지만, 기본적으로 AWS에서 사용하는 주소는 5개이므로 실질적으로 사용할 수 있는 IP 주소는 **27**(32-5)개임.

    따라서, 최소 /**26**의 CIDR Block을 선택해야 함. /**26**을 사용하면, 사용자가 사용할 수 있는 주소의 개수는 **59**(64-5)개임.

### 가용 영역

서브넷은 **특정 가용 영역(AZ)에 속함**. 

각 **가용 영역에는 하나 이상의 서브넷을 생성**할 수 있음.

### 퍼블릭 서브넷과 프라이빗 서브넷

**인터넷 게이트웨이에 연결되어 있는 서브넷은 퍼블릭 서브넷**으로, 그렇지 않은 서브넷은 **프라이빗 서브넷**으로 간주됨.

### 라우팅 테이블

**각 서브넷은 하나의 라우팅 테이블에 연결**되며, 라우팅 테이블은 서브넷 내 트래픽의 경로를 결정함.

### 보안 그룹 및 네트워크 ACL

**서브넷의 리소스는 보안 그룹과 네트워크 ACL을 통해 트래픽 제어 및 보안을 설정**할 수 있음.

## 구성요소

* **CIDR 블록**

    서브넷의 IP 주소 범위를 정의함.

* **가용 영역**

    서브넷이 속하는 AWS 가용 영역을 지정함.

* **라우팅 테이블**

    서브넷과 연결된 라우팅 테이블을 통해 트래픽 경로를 정의함.

* **인터넷 게이트웨이**

    **퍼블릭 서브넷**의 경우 인터넷 게이트웨이를 통해 인터넷과 통신함.

* **NAT 게이트웨이**

    **프라이빗 서브넷에서 인터넷으로의 아웃바운드 트래픽을 허용**하기 위해 사용됨.

* **보안 그룹**

    인스턴스 수준의 트래픽 제어를 제공함.

* **네트워크 ACL**

    **서브넷 수준의 트래픽 제어**를 제공함.

## 종류

### 퍼블릭 서브넷

**인터넷 게이트웨이에 연결되어 있어 인터넷과 직접 통신이 가능한 서브넷**임. 

주로 웹 서버와 같은 공개 접근이 필요한 리소스를 배치함.

### 프라이빗 서브넷

인터넷 게이트웨이에 연결되어 있지 않아 **외부에서 직접 접근할 수 없는 서브넷**임. 

주로 데이터베이스 서버와 같이 보안이 중요한 리소스를 배치함.

### VPN 서브넷

**고객의 온프레미스 네트워크와의 VPN 연결을 통해 통신하는 서브넷**임.

## 아키텍처

### 서브넷 생성

VPC 내에서 특정 CIDR 블록을 지정하여 서브넷을 생성함.

### 가용 영역 선택

서브넷이 위치할 가용 영역을 선택함.

### 라우팅 테이블 연결

서브넷과 라우팅 테이블을 연결하여 네트워크 트래픽의 경로를 설정함.

### 인터넷 게이트웨이 연결

**퍼블릭 서브넷**의 경우 인터넷 게이트웨이를 VPC에 연결하고 라우팅 테이블에 경로를 추가함.

### NAT 게이트웨이 설정

**프라이빗 서브넷에서 인터넷으로의 아웃바운드 트래픽을 허용**하기 위해 NAT 게이트웨이를 설정함.

### 보안 설정

**보안 그룹과 네트워크 ACL을 설정**하여 서브넷 내 리소스의 트래픽을 제어함.

## Use case

* **웹 애플리케이션 배포**

    **퍼블릭 서브넷에 웹 서버**를 배치하고, **프라이빗 서브넷에 데이터베이스 서버**를 배치하여 보안과 성능을 최적화함.

* **백엔드 서비스 격리**

    **백엔드 서비스와 데이터베이스를 프라이빗 서브넷에 배치하여 외부 접근을 차단하고 보안을 강화**함.

* **온프레미스 네트워크 통합**

    VPN 서브넷을 사용하여 온프레미스 네트워크와 안전하게 통신할 수 있음.

* **데이터 분석 워크로드**

    대규모 데이터 분석 작업을 프라이빗 서브넷에 배포하여 성능과 보안을 최적화함.

* **개발 및 테스트 환경**

    격리된 서브넷을 생성하여 개발 및 테스트 환경을 구성하고 운영 환경과 분리하여 안전하게 테스트를 수행함.

## Sumamry

AWS VPC에서 **서브넷은 IP 주소 공간을 세분화하여 리소스를 논리적으로 그룹화하고 관리할 수 있는 네트워크 세그먼트**임. 

서브넷은 **퍼블릭 서브넷과 프라이빗 서브넷으로 구분**되며, 각 서브넷은 특정 가용 영역에 속함. 

서브넷을 통해 네트워크 트래픽을 효과적으로 관리하고, 보안 정책을 적용하며, 네트워크 구조를 최적화할 수 있음. 

네트워크 세분화, 보안 강화, 고가용성 지원 등의 장점을 제공하며, 웹 애플리케이션 배포, 백엔드 서비스 격리, 온프레미스 네트워크 통합, 데이터 분석 워크로드, 개발 및 테스트 환경 등 다양한 사용 사례에 활용할 수 있음.